"use strict";var e=require("./_virtual/_tslib.js"),t=require("./NonLocalStorage.js");module.exports=function(r,o){return e.__awaiter(this,void 0,void 0,(function*(){const e=new t(r,o),i=e.ttl||36e5,n={};e.getEncryptionHandler&&(yield e.getEncryptionSettings()),e.on("setItem",(e=>{n[e.prop]=Object.assign({},e),delete n[e.prop].prop})),e.on("removeItem",(e=>{delete n[e.prop]}));const s=yield e.getAllItems();s&&Object.keys(s).forEach((e=>{n[e]=s[e]}));const l={set:(t,r,o)=>void 0===o?(e.removeItem(r),delete n[r],!0):("number"==typeof o&&isNaN(o)&&(o=0),e.setItem(r,o),n[r]={value:o,expiresAt:Date.now()+i},!0),get(t,r){if("id"===r)return e.id;const o=n[r];if(o){if(!(o.expiresAt<Date.now()))return o.value;delete n[r]}}},d={id:e.id};return new Proxy(d,l)}))};
