"use strict";var e=require("./_virtual/_tslib.js");exports.decrypt=function(t,r){return e.__awaiter(this,arguments,void 0,(function*(e,t,r={algorithm:"AES-GCM"}){const n=JSON.parse(t),i=new TextDecoder,o=Uint8Array.from(atob(n.iv),(e=>e.charCodeAt(0))),a=Uint8Array.from(atob(n.data),(e=>e.charCodeAt(0))),d=yield crypto.subtle.decrypt({name:(null==r?void 0:r.algorithm)||"AES-GCM",iv:o},e,a);return i.decode(d)}))},exports.deriveSymmetricKey=function(t,r,n){return e.__awaiter(this,arguments,void 0,(function*(e,t,r,n=1e5,i={hash:"SHA-512",derivedKeyType:{name:"AES-GCM",length:256}}){const o=new TextEncoder,a=yield crypto.subtle.importKey("raw",o.encode(e+":"+t),"PBKDF2",!1,["deriveKey"]);return crypto.subtle.deriveKey({name:"PBKDF2",salt:r,iterations:n,hash:(null==i?void 0:i.hash)||"SHA-512"},a,(null==i?void 0:i.derivedKeyType)||{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}))},exports.encrypt=function(t,r){return e.__awaiter(this,arguments,void 0,(function*(e,t,r={algorithm:"AES-GCM"}){const n=new TextEncoder,i=crypto.getRandomValues(new Uint8Array(12)),o=yield crypto.subtle.encrypt({name:(null==r?void 0:r.algorithm)||"AES-GCM",iv:i},e,n.encode(t));return JSON.stringify({iv:btoa(String.fromCharCode(...i)),data:btoa(String.fromCharCode(...new Uint8Array(o)))})}))};
