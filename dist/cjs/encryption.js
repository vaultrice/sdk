"use strict";var e=require("./_virtual/_tslib.js");exports.decrypt=function(t,r){return e.__awaiter(this,void 0,void 0,(function*(){const e=JSON.parse(r),n=new TextDecoder,i=Uint8Array.from(atob(e.iv),(e=>e.charCodeAt(0))),o=Uint8Array.from(atob(e.data),(e=>e.charCodeAt(0))),a=yield crypto.subtle.decrypt({name:"AES-GCM",iv:i},t,o);return n.decode(a)}))},exports.deriveSymmetricKey=function(t,r,n){return e.__awaiter(this,arguments,void 0,(function*(e,t,r,n=1e5){const i=new TextEncoder,o=yield crypto.subtle.importKey("raw",i.encode(e+":"+t),"PBKDF2",!1,["deriveKey"]);return crypto.subtle.deriveKey({name:"PBKDF2",salt:r,iterations:n,hash:"SHA-256"},o,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}))},exports.encrypt=function(t,r){return e.__awaiter(this,void 0,void 0,(function*(){const e=new TextEncoder,n=crypto.getRandomValues(new Uint8Array(12)),i=yield crypto.subtle.encrypt({name:"AES-GCM",iv:n},t,e.encode(r));return JSON.stringify({iv:btoa(String.fromCharCode(...n)),data:btoa(String.fromCharCode(...new Uint8Array(i)))})}))};
