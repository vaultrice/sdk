"use strict";var e=require("./_virtual/_tslib.js");exports.decrypt=function(t,r){return e.__awaiter(this,arguments,void 0,(function*(e,t,r={algorithm:"AES-GCM"}){const i=JSON.parse(t),n=new TextDecoder,o=Uint8Array.from(atob(i.iv),(e=>e.charCodeAt(0))),a=Uint8Array.from(atob(i.data),(e=>e.charCodeAt(0))),d=yield crypto.subtle.decrypt({name:(null==r?void 0:r.algorithm)||"AES-GCM",iv:o},e,a);return n.decode(d)}))},exports.deriveSymmetricKey=function(t,r,i){return e.__awaiter(this,arguments,void 0,(function*(e,t,r,i={iterations:1e5,hash:"SHA-512",derivedKeyType:{name:"AES-GCM",length:256}}){const n=new TextEncoder,o=yield crypto.subtle.importKey("raw",n.encode(e+":"+t),"PBKDF2",!1,["deriveKey"]);return crypto.subtle.deriveKey({name:"PBKDF2",salt:r,iterations:(null==i?void 0:i.iterations)||1e5,hash:(null==i?void 0:i.hash)||"SHA-512"},o,(null==i?void 0:i.derivedKeyType)||{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}))},exports.encrypt=function(t,r){return e.__awaiter(this,arguments,void 0,(function*(e,t,r={algorithm:"AES-GCM"}){const i=new TextEncoder,n=crypto.getRandomValues(new Uint8Array(12)),o=yield crypto.subtle.encrypt({name:(null==r?void 0:r.algorithm)||"AES-GCM",iv:n},e,i.encode(t));return JSON.stringify({iv:btoa(String.fromCharCode(...n)),data:btoa(String.fromCharCode(...new Uint8Array(o)))})}))};
