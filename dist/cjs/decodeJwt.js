"use strict";function r(r){let t=r.replace(/-/g,"+").replace(/_/g,"/");for(;t.length%4!=0;)t+="=";return atob(t)}module.exports=function(t){if("string"!=typeof t)throw new Error("JWT must be a string");const e=t.split(".");if(3!==e.length)throw new Error("JWT should consist of three parts: header.payload.signature");const[o,a,n]=e,s=r(o);let l;try{l=JSON.parse(s)}catch(r){throw new Error("Invalid JWT header JSON: "+r.message)}const c=r(a);let h;try{h=JSON.parse(c)}catch(r){throw new Error("Invalid JWT payload JSON: "+r.message)}return{header:l,payload:h,signatureHex:function(r){let t="";for(let e=0;e<r.length;e++)t+=r.charCodeAt(e).toString(16).padStart(2,"0");return t}(r(n))}};
