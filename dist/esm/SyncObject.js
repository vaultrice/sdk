import{__awaiter as e}from"./_virtual/_tslib.js";import t from"./NonLocalStorage.js";function o(o,r){return e(this,void 0,void 0,(function*(){const e=new t(o,r),i=e.ttl||36e5,n={};e.on("setItem",(e=>{n[e.prop]=Object.assign({},e),delete n[e.prop].prop})),e.on("removeItem",(e=>{delete n[e.prop]}));const s=yield e.getAllItems();s&&Object.keys(s).forEach((e=>{n[e]=s[e]}));const l={set:(t,o,r)=>void 0===r?(e.removeItem(o),delete n[o],!0):("number"==typeof r&&isNaN(r)&&(r=0),e.setItem(o,r),n[o]={value:r,expiresAt:Date.now()+i},!0),get(t,o){if("id"===o)return e.id;const r=n[o];if(r){if(!(r.expiresAt<Date.now()))return r.value;delete n[o]}}},p={id:e.id};return new Proxy(p,l)}))}export{o as default};
