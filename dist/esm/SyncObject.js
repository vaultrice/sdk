import{__awaiter as e}from"./_virtual/_tslib.js";import t from"./NonLocalStorage.js";function o(o,r){return e(this,void 0,void 0,(function*(){const e=new t(o,r),n=e.ttl||36e5,i={};e.getEncryptionHandler&&(yield e.getEncryptionSettings()),e.on("setItem",(e=>{i[e.prop]=Object.assign({},e),delete i[e.prop].prop})),e.on("removeItem",(e=>{delete i[e.prop]}));const s=yield e.getAllItems();s&&Object.keys(s).forEach((e=>{i[e]=s[e]}));const l={set:(t,o,r)=>void 0===r?(e.removeItem(o),delete i[o],!0):("number"==typeof r&&isNaN(r)&&(r=0),e.setItem(o,r),i[o]={value:r,expiresAt:Date.now()+n},!0),get(t,o){if("id"===o)return e.id;const r=i[o];if(r){if(!(r.expiresAt<Date.now()))return r.value;delete i[o]}}},p={id:e.id};return new Proxy(p,l)}))}export{o as default};
